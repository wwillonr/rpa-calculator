# Tech Stack Documentation

## Project Overview
**Name:** RPA ROI Calculator (rpa-roi-navigator)
**Description:** A web application for calculating Return on Investment (ROI) for Robotic Process Automation (RPA) initiatives.

## Frontend
**Core:**
- **Framework:** React 18
- **Build Tool:** Vite
- **Language:** JavaScript/TypeScript (ES Modules)

**UI & Styling:**
- **Component Library:** Material UI (MUI) v5
- **Icons:** MUI Icons Material
- **Styling Engine:** Emotion (styled-components)
- **Charts/Visualization:** Recharts

**Utilities:**
- **HTTP Client:** Axios
- **PDF Generation:** html2canvas, jspdf
- **PWA Support:** vite-plugin-pwa

**Integration:**
- **Firebase SDK:** v10.8.0

## Backend
**Core:**
- **Runtime:** Node.js
- **Framework:** Express.js
- **Module System:** ES Modules (ESM)

**Database & Services:**
- **Platform:** Firebase (Firestore, Auth)
- **SDK:** Firebase Admin SDK v12.0.0

**Security & Utilities:**
- **Security:** Helmet, CORS
- **Logging:** Morgan
- **Configuration:** Dotenv

## Development Tools
- **Process Management:** Concurrently (running frontend/backend together)
- **Hot Reloading:** Nodemon (Backend), Vite HMR (Frontend)
- **Package Manager:** npm

## Infrastructure
- **Hosting/Cloud:** Firebase (implied by dependencies and scripts)

## Application Architecture

### Directory Structure & Responsibilities

#### Frontend (`/frontend/src`)
*   **`components/`**: UI Building Blocks.
    *   **`ROIWizard.jsx`**: Core component for data collection. Manages the multi-step form state (Project Info, AS-IS, Complexity, Strategic). Validates and submits data to the backend.
    *   **`ResultsDashboard.jsx`**: Displays calculated ROI metrics, charts, and financial breakdowns after submission.
    *   **`Settings.jsx`**: Interface for configuring global assumptions (Developer rates, License costs) - acting as an Admin panel.
    *   **`steps/`**: Sub-components for each step of the ROI Wizard.
*   **`contexts/`**: Global State.
    *   **`AuthContext.jsx`**: Manages Firebase Authentication state (User session).
*   **`services/`**: API Integration.
    *   **`api.js`**: Axios instances and method wrappers for backend communication.

#### Backend (`/backend/src`)
*   **`controllers/`**: Request Handling.
    *   **`projectController.js`**: Handles incoming requests for Project creation/retrieval. Orchestrates calls to services.
    *   **`settingsController.js`**: Manages global configuration (Rates, Baselines) stored in Firestore.
*   **`services/`**: Business Logic (The Brain).
    *   **`calculationService.js`**: Contains the core algorithmic logic.
        *   `ComplexityService`: Calculates complexity score (Low/Medium/High) based on input parameters (Steps, Apps, Environment).
        *   `FinancialService`: Performs all financial math: AS-IS Costs, CAPEX (Dev Cost), OPEX (Maintenance/Licensing), ROI, and Payback formulations. Retrieves global rates from Firestore.
    *   **`projectService.js`**: Handles CRUD operations for Project documents in Firestore.
*   **`config/`**: Setup.
    *   **`firebase.js`**: Firebase Admin SDK initialization.

### Data Flow Architecture

```mermaid
graph TD
    User-->|Interacts| Frontend[Frontend (React/Vite)]
    Frontend-->|Auth| FirebaseAuth[Firebase Auth]
    
    subgraph "Frontend Components"
        ROIWizard[ROIWizard.jsx]
        Dashboard[ResultsDashboard.jsx]
    end
    
    Frontend-->|HTTP Requests| Backend[Backend API (Express)]
    
    subgraph "Backend Services"
        Controller[projectController]
        CalcService[calculationService]
        DBService[projectService]
    end
    
    Backend-->|Validate & Route| Controller
    Controller-->|Calculate Metrics| CalcService
    Controller-->|Persist Data| DBService
    
    CalcService-->|Fetch Global Rates| Firestore[(Firestore DB)]
    DBService-->|Save Project| Firestore
```

### Key Functions Breakdown

#### 1. ROI Calculation Engine (`calculationService.js`)
*   **`calculateComplexityScore(complexity)`**: 
    *   Inputs: # of Apps, Data Type (OCR/Structured), # of Steps, Environments (Array - Points are cumulative).
    *   Output: Classification (Simple...Very Complex) & Score.
*   **`calculateDevelopmentCost(teamComposition, complexityLevel)`**:
    *   Logic: Uses the complexity classification to determine the required team mix and hours, multiplied by hourly rates configured in Settings.
*   **`calculateFullROI(inputs, complexity, strategic)`**:
    *   Logic: The master function. Aggregates AS-IS operational costs, Strategic risk costs, calculated TO-BE infrastructure costs, and projected savings to output the final ROI headers.

#### 2. Settings Management
*   **Global Configuration**: The system relies on a `settings/global_config` document in Firestore. If missing, `calculationService` uses a hardcoded fallback. This allows Admins to tune costs (e.g., "Developer Hour Cost") without redeploying code.
